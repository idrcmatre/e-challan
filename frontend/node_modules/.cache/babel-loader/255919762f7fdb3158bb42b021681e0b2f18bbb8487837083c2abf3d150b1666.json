{"ast":null,"code":"// frontend/src/pages/PaymentHistory.jsx\nimport React,{useState,useEffect}from'react';import axios from'axios';import{useAuth}from'../context/AuthContext';import{jsx as _jsx,jsxs as _jsxs}from\"react/jsx-runtime\";const PaymentHistory=()=>{const{user}=useAuth();const[payments,setPayments]=useState([]);const[loading,setLoading]=useState(true);useEffect(()=>{fetchPaymentHistory();},[]);const fetchPaymentHistory=async()=>{try{const response=await axios.get('http://16.176.131.224/api/payments/history',{headers:{Authorization:`Bearer ${user.token}`}});setPayments(response.data);}catch(error){console.error('Failed to fetch payment history:',error);}finally{setLoading(false);}};const formatDate=date=>{return new Date(date).toLocaleDateString('en-IN',{year:'numeric',month:'long',day:'numeric',hour:'2-digit',minute:'2-digit'});};if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"flex justify-center items-center h-64\",children:/*#__PURE__*/_jsx(\"div\",{className:\"text-gray-500\",children:\"Loading payment history...\"})});}return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"h1\",{className:\"text-3xl font-bold text-gray-900 mb-8\",children:\"Payment History\"}),payments.length===0?/*#__PURE__*/_jsx(\"div\",{className:\"text-center py-8\",children:/*#__PURE__*/_jsx(\"p\",{className:\"text-gray-500\",children:\"No payment history found.\"})}):/*#__PURE__*/_jsxs(\"div\",{className:\"space-y-4\",children:[payments.map((payment,index)=>/*#__PURE__*/_jsxs(\"div\",{className:\"bg-white p-6 rounded-lg shadow-md\",children:[/*#__PURE__*/_jsxs(\"div\",{className:\"flex justify-between items-start mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsxs(\"h3\",{className:\"text-lg font-semibold text-gray-900\",children:[\"Transaction #\",payment.transactionId]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Challan: \",payment.challan.challanNumber]})]}),/*#__PURE__*/_jsx(\"span\",{className:\"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\",children:payment.status})]}),/*#__PURE__*/_jsxs(\"div\",{className:\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\",children:[/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Vehicle Number\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:payment.challan.vehicleNumber})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Violation Type\"}),/*#__PURE__*/_jsx(\"p\",{className:\"font-medium\",children:payment.challan.violationType})]}),/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(\"p\",{className:\"text-sm text-gray-600\",children:\"Amount Paid\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"font-medium text-green-600\",children:[\"\\u20B9\",payment.amount]})]})]}),/*#__PURE__*/_jsx(\"div\",{className:\"border-t pt-4\",children:/*#__PURE__*/_jsxs(\"p\",{className:\"text-sm text-gray-600\",children:[\"Paid on \",formatDate(payment.paymentDate)]})})]},index)),/*#__PURE__*/_jsxs(\"div\",{className:\"bg-blue-50 p-6 rounded-lg\",children:[/*#__PURE__*/_jsx(\"h3\",{className:\"text-lg font-semibold text-blue-900 mb-2\",children:\"Payment Summary\"}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-700\",children:[\"Total Payments: \",payments.length]}),/*#__PURE__*/_jsxs(\"p\",{className:\"text-blue-700\",children:[\"Total Amount: \\u20B9\",payments.reduce((sum,payment)=>sum+payment.amount,0)]})]})]})]});};export default PaymentHistory;","map":{"version":3,"names":["React","useState","useEffect","axios","useAuth","jsx","_jsx","jsxs","_jsxs","PaymentHistory","user","payments","setPayments","loading","setLoading","fetchPaymentHistory","response","get","headers","Authorization","token","data","error","console","formatDate","date","Date","toLocaleDateString","year","month","day","hour","minute","className","children","length","map","payment","index","transactionId","challan","challanNumber","status","vehicleNumber","violationType","amount","paymentDate","reduce","sum"],"sources":["/home/ubuntu/e-challan/frontend/src/pages/PaymentHistory.jsx"],"sourcesContent":["// frontend/src/pages/PaymentHistory.jsx\nimport React, { useState, useEffect } from 'react';\nimport axios from 'axios';\nimport { useAuth } from '../context/AuthContext';\n\nconst PaymentHistory = () => {\n  const { user } = useAuth();\n  const [payments, setPayments] = useState([]);\n  const [loading, setLoading] = useState(true);\n\n  useEffect(() => {\n    fetchPaymentHistory();\n  }, []);\n\n  const fetchPaymentHistory = async () => {\n    try {\n      const response = await axios.get(\n        'http://16.176.131.224/api/payments/history',\n        {\n          headers: { Authorization: `Bearer ${user.token}` }\n        }\n      );\n      setPayments(response.data);\n    } catch (error) {\n      console.error('Failed to fetch payment history:', error);\n    } finally {\n      setLoading(false);\n    }\n  };\n\n  const formatDate = (date) => {\n    return new Date(date).toLocaleDateString('en-IN', {\n      year: 'numeric',\n      month: 'long',\n      day: 'numeric',\n      hour: '2-digit',\n      minute: '2-digit'\n    });\n  };\n\n  if (loading) {\n    return (\n      <div className=\"flex justify-center items-center h-64\">\n        <div className=\"text-gray-500\">Loading payment history...</div>\n      </div>\n    );\n  }\n\n  return (\n    <div>\n      <h1 className=\"text-3xl font-bold text-gray-900 mb-8\">Payment History</h1>\n\n      {payments.length === 0 ? (\n        <div className=\"text-center py-8\">\n          <p className=\"text-gray-500\">No payment history found.</p>\n        </div>\n      ) : (\n        <div className=\"space-y-4\">\n          {payments.map((payment, index) => (\n            <div key={index} className=\"bg-white p-6 rounded-lg shadow-md\">\n              <div className=\"flex justify-between items-start mb-4\">\n                <div>\n                  <h3 className=\"text-lg font-semibold text-gray-900\">\n                    Transaction #{payment.transactionId}\n                  </h3>\n                  <p className=\"text-sm text-gray-600\">\n                    Challan: {payment.challan.challanNumber}\n                  </p>\n                </div>\n                <span className=\"px-3 py-1 rounded-full text-xs font-medium bg-green-100 text-green-800\">\n                  {payment.status}\n                </span>\n              </div>\n\n              <div className=\"grid grid-cols-1 md:grid-cols-3 gap-4 mb-4\">\n                <div>\n                  <p className=\"text-sm text-gray-600\">Vehicle Number</p>\n                  <p className=\"font-medium\">{payment.challan.vehicleNumber}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600\">Violation Type</p>\n                  <p className=\"font-medium\">{payment.challan.violationType}</p>\n                </div>\n                <div>\n                  <p className=\"text-sm text-gray-600\">Amount Paid</p>\n                  <p className=\"font-medium text-green-600\">₹{payment.amount}</p>\n                </div>\n              </div>\n\n              <div className=\"border-t pt-4\">\n                <p className=\"text-sm text-gray-600\">\n                  Paid on {formatDate(payment.paymentDate)}\n                </p>\n              </div>\n            </div>\n          ))}\n\n          <div className=\"bg-blue-50 p-6 rounded-lg\">\n            <h3 className=\"text-lg font-semibold text-blue-900 mb-2\">\n              Payment Summary\n            </h3>\n            <p className=\"text-blue-700\">\n              Total Payments: {payments.length}\n            </p>\n            <p className=\"text-blue-700\">\n              Total Amount: ₹{payments.reduce((sum, payment) => sum + payment.amount, 0)}\n            </p>\n          </div>\n        </div>\n      )}\n    </div>\n  );\n};\n\nexport default PaymentHistory;\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}